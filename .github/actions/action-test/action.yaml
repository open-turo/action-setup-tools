name: Action Test
description: Tests the action directly
inputs:
  use-versions:
    description: "Use versions"
    default: "true"
    required: true
runs:
  using: composite
  steps:
    - uses: ./.github/actions/install-tools
    - name: Install and build package
      shell: bash
      run: npm ci
    - name: Run action using inputs
      uses: ./versions
      if: inputs.use-versions == 'true'
      with:
        go: 1.17.6
        java: 17.0.2-tem
        node: 16.13.2
        python: 3.10.2
        terraform: 1.1.5
    - name: Create version files
      shell: bash
      if: inputs.use-versions != 'true'
      run: |
        echo "java=17.0.2-tem" > .sdkmanrc
        echo "16.13.2" > .node-version
        echo "3.10.2" > .python-version
        echo "1.17.6" > .go-version
        echo "1.1.5" > .terraform-version
    - name: Run action using version files
      uses: ./
      if: inputs.use-versions != 'true'
    - shell: bash
      run: go version || true
    - shell: bash
      run: java -version || true
    - shell: bash
      run: node --version || true
    - shell: bash
      run: python --version || true
    - shell: bash
      run: terraform --version || true
    - shell: bash
      run: go version | grep "1.17.6"
    - shell: bash
      run: java -version 2>&1 | grep "17.0.2"
    - shell: bash
      run: node --version | grep "16.13.2"
    - shell: bash
      run: python --version || grep "3.10.2"
    - shell: bash
      run: terraform --version | grep "1.1.5"
